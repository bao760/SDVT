--// TP ADMIN ABUES - FULL AUTO TP ON + FACE SEA + CLEAR SURFACE

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local looping = true -- AUTO TP luôn ON
local TP_POS = Vector3.new(333.46, 133.62, 217.10)
local TP_RADIUS = 5 -- bán kính đứng tại TP_POS

-- gethui support
local parentGui = (gethui and gethui()) or game.CoreGui

-- CLEAR OLD UI
for _, v in pairs(parentGui:GetChildren()) do
    if v.Name == "TpAdminAbuesUI" then
        v:Destroy()
    end
end

-- UI MAIN (giữ đơn giản)
local gui = Instance.new("ScreenGui", parentGui)
gui.Name = "TpAdminAbuesUI"
gui.ResetOnSpawn = false

-- Frame
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 260, 0, 80)
frame.Position = UDim2.new(0.1, 0, 0.2, 0)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,14)

-- Title
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.Text = "TP ADMIN ABUES"
title.TextColor3 = Color3.fromRGB(0,200,255)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 17

-- ❌ Close Button
local closeBtn = Instance.new("TextButton", frame)
closeBtn.Size = UDim2.new(0, 40, 0, 40)
closeBtn.Position = UDim2.new(1, -45, 0, 5)
closeBtn.Text = "X"
closeBtn.BackgroundColor3 = Color3.fromRGB(120, 0, 0)
closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 20
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 8)

--========================
-- FUNCTIONS
--========================

-- Kiểm tra gần TP_POS
local function isNearTP()
    local char = player.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local pos = char.HumanoidRootPart.Position
        return (pos - TP_POS).Magnitude <= TP_RADIUS
    end
    return false
end

-- Tìm vị trí biển gần nhất
local function findNearestSea(fromPos)
    local nearestPos = nil
    local shortest = math.huge
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("BasePart") then
            local name = obj.Name:lower()
            if name:find("water") or name:find("sea") or name:find("ocean") then
                local dist = (obj.Position - fromPos).Magnitude
                if dist < shortest then
                    shortest = dist
                    nearestPos = obj.Position
                end
            end
        end
    end
    return nearestPos
end

-- Teleport và quay mặt ra biển + xóa vật trên biển
local function teleportAndFaceSea()
    local char = player.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local hrp = char.HumanoidRootPart
        hrp.CFrame = CFrame.new(TP_POS)
        task.wait(0.1)
        -- Nếu đứng đúng vị trí, quay mặt ra biển
        if isNearTP() then
            local seaPos = findNearestSea(hrp.Position)
            if seaPos then
                hrp.CFrame = CFrame.new(hrp.Position, seaPos)
            end
            -- Xóa các vật thể trên mặt biển xung quanh
            for _, obj in pairs(Workspace:GetDescendants()) do
                if obj:IsA("BasePart") then
                    local name = obj.Name:lower()
                    if (name:find("water") or name:find("sea") or name:find("ocean")) and (obj.Position - hrp.Position).Magnitude <= 20 then
                        if not obj:IsA(workspace.Terrain) then
                            pcall(function() obj:Destroy() end)
                        end
                    end
                end
            end
        end
    end
end

--========================
-- AUTO TP LOOP (luôn chạy khi script load)
--========================
task.spawn(function()
    while true do
        task.wait(40) -- auto tp mỗi 5s
        if looping then
            teleportAndFaceSea()
        end
    end
end)

-- ❌ Close UI
closeBtn.MouseButton1Click:Connect(function()
    looping = false
    gui:Destroy()
end)
